---
source: Rmd
title: R 和 RStudio
teaching: 30
exercises: 0
---

```{r, include=FALSE}
```

::::::::::::::::::::::::::::::::::::::: objectives

- 描述 RStudio 脚本、控制台、环境和绘图窗格的用途。
- 将一组分析的文件和目录组织为 R 项目，并了解工作目录的用途。
- 使用内置的 RStudio 帮助界面搜索有关 R 函数的更多信息。
- 演示如何向 R 用户社区提供足够的信息以进行故障排除。

::::::::::::::::::::::::::::::::::::::::::::::::::

:::::::::::::::::::::::::::::::::::::::: questions

- 什么是 R 和 RStudio？

::::::::::::::::::::::::::::::::::::::::::::::::::

> 本集基于 Data Carpentries 的_面向生态学家的 R 语言数据分析和
> 可视化_课程。

## 什么是 R？ 什么是 RStudio？

术语 [R](https://www.r-project.org/) 用于指代
_编程语言_、_统计计算环境_
和 _解释使用该语言编写的脚本的软件_。

[RStudio](https://rstudio.com) 目前是一种非常流行的方式，不仅可以
编写 R 脚本，还可以与 R
软件进行交互[^plainr]。 为了正常运行，RStudio 需要 R 和
，因此两者都需要安装在您的计算机上。

[^plainr]: 与直接从命令行
    控制台使用 R 相反。 还有其他软件可以将
    与 R 进行接口和集成，但 RStudio 特别适合初学者
    ，同时提供许多非常高级的功能。

The RStudio IDE Cheat
Sheet
provides much more information than will be covered here, but can be
useful to learn keyboard shortcuts and discover new features.

## 为什么要学习 R？

### R 不需要大量的指向和点击，这是一件好事

学习曲线可能比其他软件更陡峭，但使用
R，您的分析结果并不依赖于记住
连续的指向和单击，而是依赖于一系列
书面命令，这是一件好事！ 因此，如果您因为收集了更多数据而想要重新进行
分析，您不必
记住您以何种顺序单击了哪个按钮来获得
结果；您只需再次运行脚本即可。

使用脚本可以使您在分析中使用的步骤更加清晰，
并且您编写的代码可以由其他人检查，他们可以为您提供
反馈并发现错误。

Working with scripts forces you to have a deeper understanding of what
you are doing, and facilitates your learning and comprehension of the
methods you use.

### R 代码具有很好的可重复性

Reproducibility means that someone else (including your future self) can
obtain the same results from the same dataset when using the same
analysis code.

R 与其他工具集成，从您的
代码生成手稿或报告。 如果您收集了更多数据，或者修复了数据集中的错误，则手稿或报告中的
图表和统计测试将自动更新
。

越来越多的期刊和资助机构希望分析
具有可重复性，因此了解 R 将使您在满足这些
要求方面更具优势。

### R 是跨学科且可扩展的

R 有超过 10000 个软件包[^whatarepkgs]可供安装以扩展其
功能，它提供了一个框架，允许您结合来自许多科学学科的
统计方法，以最适合
分析数据所需的分析框架。 例如，
R 具有用于图像分析、GIS、时间序列、人口
遗传学等的软件包。

[^whatarepkgs]: 即赋予 R 新功能的附加组件，
    例如生物信息学数据分析。

```{r, fig.cap="Exponential increase of the number of packages available on [CRAN](https://cran.r-project.org/), the Comprehensive R Archive Network. From the R Journal, Volume 10/2, December 2018.", echo=FALSE, message=FALSE}
knitr::include_graphics("fig/cran.png")
```

### R 可处理各种形状和大小的数据

您通过 R 学到的技能会随着您的
数据集的大小而轻松扩展。 无论您的数据集有数百行还是数百万行，
对您来说都不会有太大区别。

R 是为数据分析而设计的。 它带有特殊的数据结构
和数据类型，可以方便地处理缺失数据和统计
因素。

R 可以连接到您的计算机或网络上的电子表格、数据库和许多其他数据格式，
。

### R 生成高质量图形

R 中的绘图功能非常广泛，允许您调整
图形的任何方面，以最有效地传达来自
数据的信息。

### R 有一个庞大而热情的社区

每天都有成千上万的人使用 R。 他们中的许多人都愿意通过邮件列表和网站（例如 Stack
Overflow 或 RStudio
社区 为您提供帮助
。 这些广泛的用户社区
扩展到生物信息学等专业领域。 R 社区的一个这样的子集是 [Bioconductor](https://bioconductor.org/)，这是一个用于分析和理解“来自当前和新兴生物检测的数据”的科学项目。 该研讨会由 Bioconductor 社区成员开发；有关 Bioconductor 的更多信息，请参阅配套研讨会 [“Bioconductor 项目”](https://carpentries-incubator.github.io/bioc-project/)。

### R 不仅免费，而且开源且跨平台

任何人都可以检查源代码来了解 R 的工作原理。 由于这种
透明度，出现错误的可能性较小，如果您（或
其他人）发现一些错误，您可以报告并修复错误。

## 了解 RStudio

让我们首先了解 [RStudio](https://www.rstudio.com/)，
它是一个用于处理
R 的集成开发环境 (IDE)。

RStudio IDE 开源产品在 Affero General
Public License (AGPL) v3 下免费使用。
RStudio IDE 还提供商业许可和 Posit, Inc. 的
优先电子邮件支持。

我们将使用 RStudio IDE 编写代码，浏览我们
计算机上的文件，检查我们要创建的变量，并可视化
我们将生成的图表。 RStudio 还可用于其他事项
（例如版本控制、开发包、编写 Shiny 应用程序），而
我们不会在研讨会期间介绍这些事项。

```{r, results="markup", fig.cap="RStudio interface screenshot. Clockwise from top left: Source, Environment/History, Files/Plots/Packages/Help/Viewer, Console.", echo=FALSE, purl=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("fig/rstudio-screenshot.png")
```

RStudio 窗口分为 4 个“窗格”：

- 脚本和文档的**来源**（左上角，在
  默认布局中）
- 你的**环境/历史**（右上），
- 您的 **Files/Plots/Packages/Help/Viewer** （右下角），以及
- R **控制台**（左下）。

这些窗格的位置和它们的内容可以自定义（参见
菜单，“工具->全局选项->窗格布局”）。

One of the advantages of using RStudio is that all the information you
need to write code is available in a single window. 此外，通过
的许多快捷方式、**自动完成**和**突出显示**，针对您在 R 中开发时使用的主要
文件类型，RStudio 将使输入
变得更容易且更不容易出错。

## 开始设置

将一组相关数据、分析和文本
保存在一个文件夹中，称为 **工作
目录**，是一种很好的做法。 然后，此文件夹中的所有脚本都可以使用
**相对路径** 来指示
文件在项目内部的位置（而不是绝对路径，绝对路径指向
文件在特定计算机上的位置）。 Working this way makes it a lot
easier to move your project around on your computer and share it with
others without worrying about whether or not the underlying scripts
will still work.

RStudio 通过其“项目”
界面提供了一套有用的工具来执行此操作，它不仅可以为您创建工作目录，还可以记住
它的位置（允许您快速导航到它）并可选择保留
自定义设置和打开的文件，以便在
休息后更容易恢复工作。 按照下面为本
教程创建“R 项目”的步骤进行操作。

1. 启动 RStudio。
2. 在“文件”菜单下，点击“新建项目”。 选择“新目录”，然后
   “新项目”。
3. 输入这个新文件夹（或“目录”）的名称，并为其选择一个
   方便的位置。 这将是您本次会话（或整个课程）的**工作目录**
   （例如`bioc-intro`）。
4. 点击“创建项目”。
5. （可选）将首选项设置为“从不”在 RStudio 中保存工作区。

RStudio 的默认首选项通常运行良好，但将工作区保存到
.RData 可能会很麻烦，特别是在处理较大的数据集时。
要关闭该功能，请转到工具-->“全局选项”，然后在退出时选择“从不”选项
以将“工作区保存到.RData”。

```{r, results="markup", fig.cap="Set 'Save workspace to .RData on exit' to 'Never'", echo=FALSE, purl=FALSE, out.width="70%", fig.align="center"}
knitr::include_graphics("fig/rstudio-preferences.png")
```

为了避免 Windows 与其他操作系统
之间的字符编码问题，我们
将默认设置 UTF-8：

```{r, results="markup", fig.cap="Set the default text encoding to UTF-8 to save us headache in the coming future. (Figure from the link above).", echo=FALSE, purl=FALSE, out.width="70%", fig.align="center"}
knitr::include_graphics("fig/utf8.png")
```

### 组织你的工作目录

在您的项目中使用一致的文件夹结构将有助于保持事物
井然有序，并且还能让您在将来轻松查找/归档事物。 当您有多个项目时，这个
会特别有用。 一般来说，您可以
为**脚本**、**数据**和**文档**创建目录（文件夹）。

- **`data/`** 使用此文件夹存储您可能为特定分析的需要而创建的原始数据和中间
  数据集。 为了
  透明度和
  [来源](https://en.wikipedia.org/wiki/Provenance)，您应该
  _始终_ 保留原始数据的副本，并尽可能多地以编程方式 (即使用
  脚本，而不是手动) 完成
  数据清理和预处理。 将原始数据
  与处理后的数据分开也是一个好主意。 例如，你可以将
  文件“data/raw/tree_survey.plot1.txt”和“...plot2.txt”与
  由
  “scripts/01.preprocess.tree_survey.R”脚本生成的“data/processed/tree.survey.csv”文件分开保存。
- **`documents/`** 这里用来保存大纲、草稿、
  和其他文本。
- **`scripts/`**（或`src`）这将是保存用于不同分析或绘图的 R
  脚本的位置，并且可能为您的函数保存一个
  单独的文件夹（稍后会详细介绍）。

根据
项目需求，您可能需要额外的目录或子目录，但这些应该构成您工作
目录的骨干。

```{r, results="markup", fig.cap="Example of a working directory structure.", echo=FALSE, purl=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("fig/working-directory-structure.png")
```

对于本课程，我们将需要一个 `data/` 文件夹来存储我们的原始数据
并且当我们学习如何将数据导出为
CSV 文件时，我们将使用 `data_output/`，以及 `fig_output/` 文件夹来存储我们将保存的图形。

:::::::::::::::::::::::::::::::::::::::  challenge

## 挑战：创建项目目录结构

在屏幕右侧的“文件”选项卡下，单击“新建文件夹”并
在新创建的工作目录
内创建一个名为“data”的文件夹（例如，“~/bioc-intro/data”）。 （或者，在 R 控制台的
处输入 `dir.create("data")`。） 重复这些操作来创建“data_output/”和
“fig_output”文件夹。

::::::::::::::::::::::::::::::::::::::::::::::::::

我们将把脚本保存在工作目录
的根目录中，因为我们只使用一个文件，这将使事情
更容易。

您的工作目录现在应如下所示：

```{r, results="markup", fig.cap="How it should look like at the beginning of this lesson", echo=FALSE, purl=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("fig/r-starting-how-it-should-look-like.png")
```

**项目管理**也适用于生物信息学项目，
当然[^bioindatascience]。 William Noble (@Noble:2009) 建议
以下目录结构：

[^bioindatascience]: 在本课程中，我们将生物信息学视为应用于生物或生物医学数据的
    数据科学。

> 目录名称采用大字体，文件名采用较小的
> 字体。 此处仅显示一部分文件。 Note that the
> dates are formatted `<year>-<month>-<day>` so that they can be
> sorted in chronological order. 源代码“src/ms-analysis.c”
> 被编译以创建“bin/ms-analysis”并记录在
> “doc/ms-analysis.html”中。 数据目录
> 中的 `README` 文件指定了谁在哪个
> 日期从哪个 URL 下载了数据文件。 驱动脚本“results/2009-01-15/runall”自动
> 生成三个子目录split1、split2 和 split3、
> 对应三个交叉验证分割。
> `bin/parse-sqt.py` 脚本被两个 `runall` 驱动程序
> 脚本调用。

```{r bioinfoproj, fig.cap="Directory structure for a sample bioinformatics project.", out.width="100%", echo=FALSE}
knitr::include_graphics("fig/noble-bioinfo-project.png")
```

定义明确、记录良好的
项目目录最重要的方面是，让不熟悉
项目[^futureself] 的人能够

1. understand what the project is about, what data are available, what
   analyses were run, and what results were produced and, most
   importantly to

2. 再次重复分析 - 使用新数据，或更改一些
   分析参数。

[^futureself]: That someone could be, and very likely will be your
    future self, a couple of months or years after the analyses were
    run.

### 工作目录

工作目录是一个需要理解的重要概念。 它是 R 查找和保存文件的
位置。 当你
为你的项目编写代码时，它应该引用与
你的工作目录的根目录相关的文件，并且只需要这个
结构内的文件。

使用 RStudio 项目可以轻松实现此目的并确保您的工作
目录设置正确。 如果您需要检查它，您可以使用
`getwd()`。 如果由于某种原因您的工作目录不是它
应该的样子，您可以在 RStudio 界面中更改它，方法是在
文件浏览器中导航到您的工作目录应该所在的位置，然后单击
蓝色齿轮图标“更多”，然后选择“设置为工作目录”。
或者，您可以使用 `setwd("/path/to/working/directory")` 来
重置您的工作目录。 但是，您的脚本不应该包含
这一行，因为它会在别人的计算机上失败。

**例子**

下面的模式表示工作目录“bioc-intro”，其中包含
“data”和“fig_output”子目录，以及后者中的 2 个文件：

```
bioc-intro/data/
          /fig_output/fig1.pdf
          /fig_output/fig2.png
```

如果我们在工作目录中，我们可以使用相对路径“bioc-intro/fig_output/fig1.pdf”或
绝对路径“/home/user/bioc-intro/fig_output/fig1.pdf”引用“fig1.pdf”
文件。

如果我们在“数据”目录中，我们将使用相对路径
“../fig_output/fig1.pdf”或相同的绝对路径
“/home/user/bioc-intro/fig_output/fig1.pdf”。

## 与 R 交互

编程的基础是我们写下
计算机要遵循的指令，然后我们告诉计算机遵循那些
指令。 我们用 R 编写或_编码_指令，因为它是一种
通用语言，计算机和我们都能理解。 我们将
指令称为 _命令_，并告诉计算机通过 _执行_（也称为 _运行_）这些命令来遵循
指令。

与 R 交互的主要方式有两种：使用
**控制台** 或使用 **脚本**（包含
代码的纯文本文件）。 控制台窗格（在 RStudio 中，左下方面板）是
用 R 语言编写的命令可以被计算机输入并
立即执行的地方。 它还将显示已执行命令的结果
。 您可以直接在控制台中输入
命令，然后按 `Enter` 来执行那些
命令，但是当您关闭会话时它们会被遗忘。

因为我们希望我们的代码和工作流程具有可重现性，所以最好
在脚本编辑器中输入我们想要的命令，然后保存
脚本。 这样，我们所做的事情就有了完整的记录，而且
任何人（包括我们未来的自己！） 可以轻松地在他们的计算机上复制
的结果。 但是请注意，仅在脚本中输入命令
并不能自动_运行_它们 - 它们仍然需要通过
发送到控制台进行执行。

RStudio 允许您使用 `Ctrl` + `Enter` 快捷键直接从脚本编辑器
执行命令（在 Mac 上，`Cmd` + `Return` 也可以
起作用）。 当您按下 `Ctrl` +
`Enter` 时，脚本中当前行的命令（光标指示为
）或当前选定的文本
中的所有命令将被发送到控制台并执行。 您可以在此 RStudio
有关 RStudio
IDE 的备忘单 中找到其他键盘快捷键。

在分析的某个阶段，您可能想要检查
变量的内容或对象的结构，而不一定在脚本中保留它的
记录。 You can type these commands and execute
them directly in the console.  RStudio 提供了 `Ctrl` + `1` 和
`Ctrl` + `2` 快捷键，允许您在脚本和
控制台窗格之间跳转。

如果 R 准备好接受命令，R 控制台将显示 `>` 提示。 如果
收到一个命令（通过键入、复制粘贴或使用 `Ctrl` + `Enter` 从脚本
编辑器发送），R 将尝试执行它，并且当
准备就绪时，将显示结果并返回一个新的 `>` 提示符以
等待新命令。

If R is still waiting for you to enter more data because it isn't
complete yet, the console will show a `+` prompt. 这意味着你
还没有输入完整的命令。 This is because you have
not 'closed' a parenthesis or quotation, i.e. you don't have the same
number of left-parentheses as right-parentheses, or the same number of
opening and closing quotation marks.  当这种情况发生时，如果你
认为你已经完成了命令输入，请单击控制台
窗口内并按 `Esc`；这将取消不完整的命令并且
返回到 `>` 提示符。

## 如何在课程中和课程结束后学习更多知识？

我们在本课程中涵盖的材料将为您提供初步的
体验如何使用 R 分析数据以进行您自己的
研究。 但是，您需要学习更多知识才能执行高级
操作，例如清理数据集、使用统计方法、
或创建漂亮的图形[^inthiscoure]。 The best way to become
proficient and efficient at R, as with any other tool, is to use it to
address your actual research questions. 对于初学者来说，从头开始编写脚本可能会让人感到
畏惧，而考虑到许多
人将他们的代码发布到网上，修改现有代码以
满足你的目的可能会让你更容易上手。

[^inthiscoure]: 我们将在这里介绍其中的大部分内容（统计数据除外）
    ，但只能触及使用 R 可以实现的
    的丰富内容的表面。

```{r kitten, results="markup", echo=FALSE, purl=FALSE, out.width="400px", fig.align="center"}
knitr::include_graphics("fig/kitten-try-things.jpg")
```

## 寻求帮助

### 使用内置的 RStudio 帮助界面搜索有关 R 函数的更多信息

```{r rstudiohelp, fig.cap="RStudio help interface.", results="markup", echo=FALSE, purl=FALSE, out.width="70%", fig.align="center"}
knitr::include_graphics("fig/rstudiohelp.png")
```

获得帮助的最快方法之一是使用 RStudio 帮助
界面。 默认情况下，该面板位于 RStudio 右下角
面板。 如屏幕截图所示，通过输入单词
“Mean”，RStudio 还会尝试提供一些您
可能感兴趣的建议。 然后描述就会显示在显示
窗口中。

### 我知道我想使用的函数的名称，但我不知道如何使用它

如果您需要有关特定函数的帮助，比如说 `barplot()`，您
可以输入：

```{r, eval=FALSE, purl=TRUE}
?barplot
```

如果您只需要提醒自己参数的名称，您可以使用：

```{r, eval=FALSE, purl=TRUE}
args(lm)
```

### 我想使用一个执行 X 的函数，一定有一个函数可以执行该操作，但我不知道是哪一个......

如果您正在寻找一个函数来执行特定任务，您可以使用
`help.search()`函数，它由双问号`??`调用。
However, this only looks through the installed packages for help pages with a
match to your search request

```{r, eval=FALSE, purl=TRUE}
??kruskal
```

如果您找不到所需内容，您可以使用
[rdocumentation.org](https://www.rdocumentation.org) 网站，该网站通过所有可用软件包中的帮助文件进行搜索
。

Finally, a generic Google or internet search "R \<task>" will often either send
you to the appropriate package documentation or a helpful forum where someone
else has already asked your question.

### 我被困住了…… 我收到一条我无法理解的错误消息

首先通过谷歌搜索错误信息。 但是，这种方法并不总是能很好地发挥作用
因为通常包开发人员依赖于 R 提供的错误捕获功能。您
最终会得到一般错误消息，而这些消息可能对诊断
问题（例如“下标越界”）没有多大帮助。 如果消息非常通用，您
可能还会在
查询中包含您正在使用的函数或包的名称。

但是，您应该检查一下 Stack Overflow。 使用 `[r]` 标签搜索。 大多数
问题已经得到解答，但挑战在于在搜索中使用正确的
词来找到
答案：

[http://stackoverflow.com/questions/tagged/r](https://stackoverflow.com/questions/tagged/r)

[R 简介](https://cran.r-project.org/doc/manuals/R-intro.pdf) 对于编程经验较少的人来说可能
比较难懂，但是它是
了解 R 语言基础知识的好地方。

[R FAQ](https://cran.r-project.org/doc/FAQ/R-FAQ.html) 内容密集且技术性很强
但其中包含大量有用信息。

### 寻求帮助

获得他人帮助的关键是让他们迅速掌握
你的问题。 You should make it as easy as possible to pinpoint where
the issue might be.

尝试使用正确的词语来描述你的问题。 例如，
包与库不同。 大多数人会
理解你的意思，但其他人对含义的差异有很强烈的感受
。 The key point is that it can make
things confusing for people trying to help you. 描述问题时请尽可能精确（
）。

如果可能的话，尝试将不起作用的部分简化为一个简单的_可重现的
示例_。 如果您可以使用非常小的数据
框架而不是 50000 行和 10000 列的框架重现该问题，请提供
小框架并描述您的问题。 在适当的时候，尝试
来概括你正在做的事情，这样即使不在你的
领域的人也能理解这个问题。 例如，不要使用真实数据集的
子集，而是创建一个小的（3 列，5 行）
通用数据集。 有关如何编写可重现的
示例的更多信息，请参阅 Hadley
Wickham 的这篇文章。

要与他人共享一个对象，如果它相对较小，您
可以使用函数“dput()”。 它将输出可用于
重新创建与内存中完全相同的对象：

```{r, results="show", purl=TRUE}
## iris is an example data frame that comes with R and head() is a
## function that returns the first part of the data frame
dput(head(iris))
```

如果对象较大，请提供原始文件（即您的 CSV
文件）以及您的脚本直到出现错误的位置（并且在
之后删除与您的
问题无关的所有内容）。 Alternatively, in particular if your question is not related
to a data frame, you can save any R object to a file[^export]:

```{r, eval=FALSE, purl=FALSE}
saveRDS(iris, file="/tmp/iris.rds")
```

但是，该文件的内容不是人类可读的，并且无法
直接发布在 Stack Overflow 上。 相反，它可以通过电子邮件发送给某个人
，该人可以使用 `readRDS()` 命令阅读它（这里
假设下载的文件位于
用户主目录中的 `Downloads` 文件夹中）：

```{r, eval=FALSE, purl=FALSE}
some_data <- readRDS(file="~/Downloads/iris.rds")
```

最后，但同样重要的一点是，**始终包含 `sessionInfo()`**
的输出，因为它提供了有关您的平台、R 版本和
您正在使用的软件包的重要信息，以及其他对
理解您的问题非常有帮助的信息。

```{r, results="show", purl=TRUE}
sessionInfo()
```

### 去哪里寻求帮助？

- 课程期间坐在您旁边的人。 不要犹豫，
  在研讨会期间与你的邻居交谈，比较你的答案，
  并寻求帮助。
- 友好的同事：如果您认识某个比您更有经验
  的人，他们也许能够并且愿意帮助您。
- [Stack Overflow](https://stackoverflow.com/questions/tagged/r): 如果
  你的问题之前没有被回答过并且回答得很好，那么
  你很有可能在 5 分钟内得到答案。 Remember to
  follow their guidelines on how to ask a good
  question.
- R-help 邮件
  列表：有
  很多人 (包括大多数 R 核心团队成员) 阅读它，也有
  很多人向其发帖，但其语气可能相当枯燥，并且对新用户并不总是
  欢迎。 If your question is valid, you are
  likely to get an answer very fast but don't expect that it will come
  with smiley faces. 此外，在这里比在其他地方更重要的是，一定要确保
  使用正确的词汇（否则您可能会得到一个指向
  用词不当的答案，而不是回答您的
  问题）。 如果您的问题是关于
  基本函数而不是特定的包，您也会获得更多的成功。
- 如果您的问题是关于特定软件包的，请查看是否有该软件包的
  邮件列表。 通常它包含在包的描述文件
  中，可以使用
  `packageDescription("name-of-package")` 来访问。 您可能还想尝试
  直接给软件包的作者发送电子邮件，或者在
  代码存储库（例如 GitHub）上打开一个问题。
- 还有一些特定主题的邮件列表（GIS、
  系统发育学等...），完整列表在
  [这里](https://www.r-project.org/mail.html)。

### 更多资源

- R 邮件列表的 [发帖指南](https://www.r-project.org/posting-guide.html)。

- 如何寻求 R
  帮助
  有用的指南。

- Jon
  Skeet 的这篇博客文章
  对如何提出编程问题提供了相当全面的建议。

- [reprex](https://cran.rstudio.com/web/packages/reprex/) 包
  在寻求
  帮助时对于创建可重现的示例非常有帮助。 rOpenSci 社区呼吁“如何提出问题以便得到
  答案”（Github
  链接 和 视频
  录音）包括对
  reprex 包及其理念的介绍。

## R 包

### 加载包

正如我们上面看到的，R 包在 R 中起着基础性的作用。
利用包的功能，假设它已安装，我们
首先需要加载它才能使用它。 这是通过
`library()` 函数完成的。 下面，我们加载“ggplot2”。

```{r loadp, eval=FALSE, purl=TRUE}
library("ggplot2")
```

### 安装软件包

The default package repository is The _Comprehensive R Archive
Network_ (CRAN), and any package that is available on CRAN can be
installed with the `install.packages()` function. 下面，例如，
我们安装稍后将了解的 `dplyr` 包。

```{r craninstall, eval=FALSE, purl=TRUE}
install.packages("dplyr")
```

此命令将安装“dplyr”包及其所有
依赖项，即它所依赖的所有包。

另一个主要的 R 包存储库由 Bioconductor 维护。 [Bioconductor 软件包](https://bioconductor.org/packages/release/BiocViews.html#___Software) 使用专用软件包
即 `BiocManager` 进行管理和安装，可以使用以下命令从 CRAN 安装：

```{r, eval=FALSE, purl=TRUE}
install.packages("BiocManager")
```

Individual packages such as `SummarizedExperiment` (we will use it
later), `DESeq2` (for RNA-Seq analysis), and any others from either Bioconductor or CRAN can then be
installed with `BiocManager::install`.

```{r, eval=FALSE, purl=TRUE}
BiocManager::install("SummarizedExperiment")
BiocManager::install("DESeq2")
```

默认情况下，`BiocManager::install()` 还将检查所有已安装的软件包，查看是否有可用的新版本。 如果有，它会向您显示并询问您是否要“更新全部/部分/无？” [a/s/n]:\`然后等待您的答复。 虽然您应该努力获得最新的软件包版本，但实际上我们建议仅在加载任何包之前在新的 R 会话中更新包。

:::::::::::::::::::::::::::::::::::::::: keypoints

- 开始使用 R 和 RStudio

::::::::::::::::::::::::::::::::::::::::::::::::::
